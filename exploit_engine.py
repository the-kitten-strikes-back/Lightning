import os
import importlib

class ExploitEngine:
    def __init__(self):
        self.exploits = []

    def load_exploits(self, path="exploits"):
        for root, _, files in os.walk(path):
            for f in files:
                if f.endswith(".py") and not f.startswith("_"):
                    module_path = root.replace("/", ".") + "." + f[:-3]
                    module = importlib.import_module(module_path)
                    if hasattr(module, "INFO"):
                        self.exploits.append(module)

    def match(self, service, port, os_name=None):
        return [
            e for e in self.exploits
            if e.INFO["service"] == service and e.INFO["port"] == port
        ]
